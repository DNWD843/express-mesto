(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{56:function(e,t,a){e.exports=a.p+"static/media/headerLogo.c6f11019.svg"},63:function(e,t,a){e.exports=a(73)},68:function(e,t,a){},73:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),i=a(55),r=a.n(i),s=(a(68),a(60)),l=a(38),c=a(39),u=a(62),d=a(61),m=a(56),p=a.n(m);var h=function(){return o.a.createElement("header",{className:"header page__header"},o.a.createElement("img",{className:"header__logo",src:p.a,alt:"\u043b\u043e\u0433\u043e\u0442\u0438\u043f \u043f\u0440\u043e\u0435\u043a\u0442\u0430 '\u041c\u0435\u0441\u0442\u043e-\u0420\u043e\u0441\u0441\u0438\u044f'"}))},f=o.a.createContext({});var _=function(e){var t=e.id,a=e.link,n=e.title,i=e.likesQuantity,r=e.owner,s=e.likes,l=e.onCardClick,c=e.onCardLike,u=e.onCardDelete,d=o.a.useContext(f),m=r._id===d._id,p=s.some((function(e){return e._id===d._id}));return o.a.createElement("li",{className:"card"},o.a.createElement("img",{className:"card__image",onClick:function(){l({link:a,title:n})},src:a,alt:n,name:"photo",title:"\u041e\u0442\u043a\u0440\u044b\u0442\u044c \u0444\u043e\u0442\u043e"}),o.a.createElement("button",{type:"button",onClick:function(){u({id:t})},className:"button button_type_delete card__delete-button ".concat(m?"card__delete-button_enabled":""),name:"delete-button",value:"delete",title:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c \u0444\u043e\u0442\u043e"}),o.a.createElement("div",{className:"card__description"},o.a.createElement("h2",{className:"card__title"},n),o.a.createElement("div",{className:"card__like-info"},o.a.createElement("button",{type:"button",onClick:function(){c({id:t,likes:s})},className:"button button_type_like card__like-button  ".concat(p?"button_like-status_checked":"button_like-status_not-checked"),name:"like-button",value:"like"}),o.a.createElement("span",{className:"card__like-counter"},i))))};var v=function(e){var t=o.a.useContext(f);return o.a.createElement("main",{className:"content page__content"},o.a.createElement("section",{className:"user-profile content__user-profile",key:"user-profile"},o.a.createElement("button",{type:"button",onClick:e.onEditAvatar,className:"button  user-profile__avatar-button",style:{backgroundImage:"url(".concat(t.avatar,")")},name:"edit-avatar-form-button",id:"edit-avatar-form-button",value:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",title:"\u0418\u0437\u043c\u0435\u043d\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440"}),o.a.createElement("div",{className:"user-profile__user-info"},o.a.createElement("h1",{className:"user-profile__user-name"},t.name),o.a.createElement("button",{type:"button",onClick:e.onEditProfile,className:"button button_type_edit user-profile__edit-button",name:"edit-profile-form-button",id:"edit-profile-form-button",value:"\u041e\u0442\u043a\u0440\u044b\u0442\u044c \u0444\u043e\u0440\u043c\u0443",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c"}),o.a.createElement("p",{className:"user-profile__user-job"},t.about)),o.a.createElement("button",{type:"button",onClick:e.onAddPlace,className:"button button_type_add user-profile__add-button",name:"add-photo-form-button",id:"add-photo-form-button",value:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0444\u043e\u0442\u043e",title:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u0444\u043e\u0442\u043e"})),o.a.createElement("section",{className:"photo content__photo",key:"photo-cards"},o.a.createElement("ul",{className:"photo__cards"},e.cards.map((function(t){return o.a.createElement(_,Object.assign({key:t.id},t,{onCardClick:e.onCardClick,onCardLike:e.onCardLike,onCardDelete:e.onCardDelete}))})))))};var k=function(){return o.a.createElement("footer",{className:"footer"},o.a.createElement("p",{className:"footer__copyright"},"\xa9 2020 Mesto Russia"))};var b=function(e){return o.a.createElement("div",{onClick:e.onOverlayClick,className:"popup page__overlay page__overlay_theme_dark popup_type_view-photo ".concat(e.isOpen?"popup_opened":""),id:"view"},o.a.createElement("div",{className:"popup__container"},o.a.createElement("button",{type:"button",onClick:e.onClose,className:"button button_type_close popup__close-photo-button",name:"close-photo",value:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c \u0444\u043e\u0442\u043e"}),o.a.createElement("figure",{className:"popup__photo-content"},o.a.createElement("img",{className:"popup__place-image",src:"".concat(e.card?e.card.link:"#","  "),alt:"".concat(e.card?e.card.title:"\u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435")}),o.a.createElement("figcaption",{className:"popup__place-name"},"".concat(e.card?e.card.title:"\u0438\u0437\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435")))))},C=new(function(){function e(t){var a=t.URLs,n=t.headers,o=t.token;Object(l.a)(this,e),this._baseURL=a.baseURL,this._cardsURL=a.cardsURL,this._userURL=a.userURL,this._likesURL=a.likesURL,this._avatarURL=a.avatarURL,this._headers=n,this._token=o}return Object(c.a)(e,[{key:"loadUserData",value:function(){return fetch(this._userURL,{headers:{authorization:this._token}}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"loadCards",value:function(){return fetch(this._cardsURL,{headers:{authorization:this._token}}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"addNewCard",value:function(e){return fetch(this._cardsURL,{method:"POST",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e.name,link:e.link})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"deleteCard",value:function(e){return fetch("".concat(this._cardsURL).concat(e),{method:"DELETE",headers:{authorization:this._token}}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"editProfile",value:function(e){var t=e.name,a=e.about;return fetch("".concat(this._userURL),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:t,about:a})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"changeLikeCardStatus",value:function(e,t){return fetch("".concat(this._likesURL).concat(e),{method:"".concat(t?"PUT":"DELETE"),headers:{authorization:this._token}}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"editAvatar",value:function(e){return fetch("".concat(this._avatarURL),{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}}]),e}())({URLs:{baseURL:"https://mesto.nomoreparties.co/v1/cohort-14/",cardsURL:"https://mesto.nomoreparties.co/v1/cohort-14/cards/",userURL:"https://mesto.nomoreparties.co/v1/cohort-14/users/me/",likesURL:"https://mesto.nomoreparties.co/v1/cohort-14/cards/likes/",avatarURL:"https://mesto.nomoreparties.co/v1/cohort-14/users/me/avatar/"},headers:{authorization:"85abb6e6-ccb0-45c7-b6e8-4ffe1f5da546"},token:"85abb6e6-ccb0-45c7-b6e8-4ffe1f5da546"});var E=function(e){return o.a.createElement("div",{onClick:e.onOverlayClick,className:"popup page__overlay page__overlay_theme_light popup_type_".concat(e.name," ").concat(e.isOpen?"popup_opened":""),id:e.name},o.a.createElement("div",{className:"popup__container"},o.a.createElement("button",{type:"button",onClick:e.onClose,className:"button button_type_close popup__close-button",name:"close-popup",value:"\u0417\u0430\u043a\u0440\u044b\u0442\u044c"}),o.a.createElement("form",{onSubmit:e.onSubmit,className:"form popup__form form_type_".concat(e.name),name:"".concat(e.name,"-form"),id:"".concat(e.name,"-form")},o.a.createElement("h2",{className:"form__title"},e.title),e.children,o.a.createElement("button",{type:"submit",disabled:!e.isReadyToSubmit,className:"button ".concat(e.isReadyToSubmit?"button_type_submit":"button_type_submit-inactive"," form__submit-button"),name:"".concat(e.name,"-button"),value:e.submitButtonText},e.isLoading?e.preloaderText:e.submitButtonText))))},y=a(34),g=a(11);var O=function(e){var t=o.a.useContext(f),a=Object(y.a)({initialValues:{name:"",description:""},validationSchema:g.a({name:g.b().min(3,"Must be 3 characters or more").max(15,"Must be 15 characters or less").required("Required"),description:g.b().min(3,"Must be 3 characters or more").max(35,"Must be 35 characters or less").required("Required")}),onSubmit:function(){e.onUpdateUser({name:i,about:r})}}),n=a.values,i=n.name,r=n.description;return o.a.useEffect((function(){e.isOpen&&a.setValues({name:t.name,description:t.about})}),[e.isOpen]),o.a.createElement(E,{name:"edit-profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",submitButtonText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onOverlayClick:e.onOverlayClick,onSubmit:a.handleSubmit,isLoading:e.isLoading,preloaderText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...",isReadyToSubmit:a.isValid},o.a.createElement(o.a.Fragment,null,o.a.createElement("ul",{className:"form__inputs"},o.a.createElement("li",{className:"form__field"},o.a.createElement("input",{id:"user-name-input",name:"name",type:"text",onChange:a.handleChange,onBlur:a.handleBlur,value:i||"",className:"form__input form__input_type_name",placeholder:"\u0418\u043c\u044f"}),a.touched.name&&a.errors.name?o.a.createElement("span",{className:"form__input-error",id:"user-name-input-error"},a.errors.name):null),o.a.createElement("li",{className:"form__field"},o.a.createElement("input",{id:"user-job-input",name:"description",type:"text",onChange:a.handleChange,onBlur:a.handleBlur,value:r||"",className:"form__input form__input_type_job",placeholder:"\u041e \u0441\u0435\u0431\u0435"}),a.touched.description&&a.errors.description?o.a.createElement("span",{className:"form__input-error",id:"user-job-input-error"},a.errors.description):null))))};var P=function(e){var t=Object(y.a)({initialValues:{avatar:""},validationSchema:g.a({avatar:g.b().url("Invalid URL").required("Required")}),onSubmit:function(){e.onUpdateAvatar({avatar:a})}}),a=t.values.avatar;return o.a.useEffect((function(){e.isOpen||t.resetForm()}),[e.isOpen]),o.a.createElement(E,{name:"edit-avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",submitButtonText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onOverlayClick:e.onOverlayClick,onSubmit:t.handleSubmit,isLoading:e.isLoading,preloaderText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...",isReadyToSubmit:Boolean(a)&&t.isValid,children:o.a.createElement("ul",{className:"form__inputs"},o.a.createElement("li",{className:"form__field"},o.a.createElement("input",{id:"avatar-link-input",name:"avatar",type:"url",onChange:t.handleChange,onBlur:t.handleBlur,value:a||"",className:"form__input form__input_type_avatar-link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443"}),t.errors.avatar?o.a.createElement("span",{className:"form__input-error",id:"avatar-link-input-error"},t.errors.avatar):null))})},N=function(e){var t=Object(y.a)({initialValues:{title:"",link:""},validationSchema:g.a({title:g.b().min(3,"Must be 3 characters or more").max(15,"Must be 15 characters or less").required("Required"),link:g.b().url("Invalid URL").required("Required")}),onSubmit:function(t){e.onSubmit({name:t.title,link:i})}}),a=t.values,n=a.title,i=a.link;return o.a.useEffect((function(){e.isOpen||t.resetForm()}),[e.isOpen]),o.a.createElement(E,{name:"add-photo",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",submitButtonText:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isOpen:e.isOpen,onClose:e.onClose,onOverlayClick:e.onOverlayClick,onSubmit:t.handleSubmit,isLoading:e.isLoading,preloaderText:"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...",isReadyToSubmit:Boolean(i)&&Boolean(n)&&t.isValid},o.a.createElement("ul",{className:"form__inputs"},o.a.createElement("li",{className:"form__field"},o.a.createElement("input",{id:"place-title-input",name:"title",type:"text",onChange:t.handleChange,onBlur:t.handleBlur,value:n||"",className:"form__input form__input_type_place-title",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435"}),t.touched.title&&t.errors.title?o.a.createElement("span",{className:"form__input-error"},t.errors.title):null),o.a.createElement("li",{className:"form__field"},o.a.createElement("input",{id:"image-link-input",name:"link",type:"url",onChange:t.handleChange,onBlur:t.handleBlur,value:i||"",className:"form__input form__input_type_image-link",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443"}),t.touched.link&&t.errors.link?o.a.createElement("span",{className:"form__input-error"},t.errors.link):null)))};var L=function(e){return o.a.createElement(E,{name:"confirm",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",submitButtonText:"\u0414\u0430",onClose:e.onClose,onOverlayClick:e.onOverlayClick,isOpen:e.isOpen,onSubmit:e.onSubmit,isLoading:e.isProcessing,preloaderText:"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435...",isReadyToSubmit:!0})},S=function(e){Object(u.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this)).closeAllPopups=function(){document.removeEventListener("keydown",n.handleEscClose),n.setState({isEditProfilePopupOpen:!1,isAddPlacePopupOpen:!1,isEditAvatarPopupOpen:!1,isDeleteConfirmPopupOpen:!1,isImagePopupOpen:!1,selectedCard:void 0})},n.handleEscClose=function(e){"Escape"===e.key&&n.closeAllPopups()},n.handleClickOnOverlay=function(e){e.target===e.currentTarget&&n.closeAllPopups()},n.handleCardLike=function(e){var t=e.likes.some((function(e){return e._id===n.state.currentUser._id}));C.changeLikeCardStatus(e.id,!t).then((function(t){var a=n.state.cards.map((function(a){return a.id===e.id?{id:t._id,link:t.link,title:t.name,likesQuantity:t.likes.length,owner:t.owner,likes:t.likes}:a}));n.setState({cards:a})})).catch((function(e){console.log(e)}))},n.handleCardClick=function(e){document.addEventListener("keydown",n.handleEscClose),n.setState({selectedCard:e}),n.setState({isImagePopupOpen:!0})},n.handleCardDelete=function(e){n.setState({isDeleteConfirmPopupOpen:!0}),n.setState({selectedCard:e})},n.handleDeleteConfirm=function(e){e.preventDefault();var t=n.state.selectedCard;n.setState({isDeleteProcessing:!0}),C.deleteCard(t.id).then((function(){var e=n.state.cards.filter((function(e){return e.id!==t.id}));n.setState({cards:e}),n.closeAllPopups()})).catch((function(e){console.log(e)})).finally((function(){n.setState({isDeleteProcessing:!1})}))},n.handleEditAvatarClick=function(){document.activeElement.blur(),document.addEventListener("keydown",n.handleEscClose),n.setState({isEditAvatarPopupOpen:!0})},n.handleUpdateAvatar=function(e){var t=e.avatar;n.setState({isNewAvatarLoading:!0}),C.editAvatar(t).then((function(e){n.setState({currentUser:e}),n.closeAllPopups()})).catch((function(e){console.log(e)})).finally((function(){n.setState({isNewAvatarLoading:!1})}))},n.handleEditProfileClick=function(){document.activeElement.blur(),document.addEventListener("keydown",n.handleEscClose),n.setState({isEditProfilePopupOpen:!0})},n.handleUpdateUser=function(e){var t=e.name,a=e.about;n.setState({isNewProfileLoading:!0}),C.editProfile({name:t,about:a}).then((function(e){n.setState({currentUser:e}),n.closeAllPopups()})).catch((function(e){console.log(e)})).finally((function(){n.setState({isNewProfileLoading:!1})}))},n.handleAddPlaceClick=function(){document.activeElement.blur(),document.addEventListener("keydown",n.handleEscClose),n.setState({isAddPlacePopupOpen:!0})},n.handleAddPlaceSubmit=function(e){var t=e.name,a=e.link;n.setState({isNewCardLoading:!0}),C.addNewCard({name:t,link:a}).then((function(e){var t={id:e._id,link:e.link,title:e.name,likesQuantity:e.likes.length,owner:e.owner,likes:e.likes},a=n.state.cards.concat(t);n.setState({cards:a}),n.closeAllPopups()})).catch((function(e){console.log(e)})).finally((function(){n.setState({isNewCardLoading:!1})}))},n.state={isEditProfilePopupOpen:!1,isAddPlacePopupOpen:!1,isEditAvatarPopupOpen:!1,isDeleteConfirmPopupOpen:!1,isImagePopupOpen:!1,selectedCard:void 0,currentUser:{},cards:[],isNewProfileLoading:!1,isNewAvatarLoading:!1,isNewCardLoading:!1,isDeleteProcessing:!1},n}return Object(c.a)(a,[{key:"componentDidMount",value:function(){var e=this;Promise.all([C.loadUserData(),C.loadCards()]).then((function(t){var a=Object(s.a)(t,2),n=a[0],o=a[1];e.setState({currentUser:n});var i=o.map((function(e){return{id:e._id,link:e.link,title:e.name,likesQuantity:e.likes.length,owner:e.owner,likes:e.likes}}));e.setState({cards:i})})).catch((function(e){console.log(e)}))}},{key:"render",value:function(){return o.a.createElement(o.a.Fragment,null,o.a.createElement(f.Provider,{value:this.state.currentUser},o.a.createElement(h,null),o.a.createElement(v,{onEditProfile:this.handleEditProfileClick,onAddPlace:this.handleAddPlaceClick,onEditAvatar:this.handleEditAvatarClick,onCardClick:this.handleCardClick,onCardLike:this.handleCardLike,onCardDelete:this.handleCardDelete,cards:this.state.cards}),o.a.createElement(k,null),o.a.createElement(O,{isOpen:this.state.isEditProfilePopupOpen,onClose:this.closeAllPopups,onOverlayClick:this.handleClickOnOverlay,onUpdateUser:this.handleUpdateUser,isLoading:this.state.isNewProfileLoading}),o.a.createElement(P,{isOpen:this.state.isEditAvatarPopupOpen,onClose:this.closeAllPopups,onOverlayClick:this.handleClickOnOverlay,onUpdateAvatar:this.handleUpdateAvatar,isLoading:this.state.isNewAvatarLoading}),o.a.createElement(N,{isOpen:this.state.isAddPlacePopupOpen,onClose:this.closeAllPopups,onOverlayClick:this.handleClickOnOverlay,onSubmit:this.handleAddPlaceSubmit,isLoading:this.state.isNewCardLoading}),o.a.createElement(L,{isOpen:this.state.isDeleteConfirmPopupOpen,onClose:this.closeAllPopups,onOverlayClick:this.handleClickOnOverlay,onSubmit:this.handleDeleteConfirm,isProcessing:this.state.isDeleteProcessing}),o.a.createElement(b,{card:this.state.selectedCard,onClose:this.closeAllPopups,onOverlayClick:this.handleClickOnOverlay,isOpen:this.state.isImagePopupOpen})))}}]),a}(o.a.Component);r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(S,null)),document.getElementById("root"))}},[[63,1,2]]]);
//# sourceMappingURL=main.00d5414c.chunk.js.map